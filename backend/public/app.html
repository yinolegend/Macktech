<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Mack — App</title>
    <style>
      :root { --sidebar-w:320px; --brand:#0b74ff; --muted:#6b7a99 }
      .top-button{ background:linear-gradient(180deg,#dff0ff,#cfefff); border:1px solid rgba(11,116,255,0.12); color:var(--brand); padding:8px 12px; border-radius:8px; cursor:pointer; font-weight:600 }
      .top-header{ display:flex; align-items:center; justify-content:space-between; gap:12px }
      body { font-family: system-ui, -apple-system, Arial; margin:0; display:flex; height:100vh; background:linear-gradient(180deg,#f6fbff,#ffffff) }
      #sidebar { width:var(--sidebar-w); border-right:1px solid rgba(11,116,255,0.06); padding:16px; box-sizing:border-box; overflow:auto; background:linear-gradient(180deg,#f8fbff,#ffffff) }
      #main { flex:1; padding:16px; box-sizing:border-box; display:flex; flex-direction:column }
      .messages { flex:1; overflow:auto; border:1px solid #e9f2ff; padding:8px; margin-bottom:8px; background:white }
      .message { padding:6px 8px; border-bottom:1px solid #f2f8ff }
      .ticket { border:1px solid #e6f0ff; padding:8px; margin-bottom:8px; background:white }
      form { display:flex; gap:8px; flex-direction:column }
      input[type="text"], textarea, input { width:100%; padding:8px; border-radius:6px; border:1px solid #ddeeff }
      button.btn { padding:8px 10px; border-radius:6px; border:0; cursor:pointer }
      button.btn.primary { background:var(--brand); color:white }
      button.btn.ghost { background:transparent; border:1px solid rgba(11,116,255,0.12); color:var(--brand) }
      nav { display:flex; gap:8px; margin-bottom:12px }
      .section { display:none; height:100%; }
      .section.active { display:block; }
      h2 { color:var(--brand) }
    </style>
  </head>
  <body>
    <div id="sidebar">
      <!-- Sidebar (navigation moved to the main landing page). -->

      <div id="tickets-list-mini" style="margin-top:12px"></div>
      <div id="create-ticket-block">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-top:12px">
          <h3 style="margin:0">Create Ticket</h3>
          <button id="btnHomeInCreate" class="top-button" title="Home">Home</button>
        </div>
        <form id="ticket-form">
          <input name="title" placeholder="Title" required />
          <textarea name="description" placeholder="Description"></textarea>
          <input id="ticket-requester" name="requester" placeholder="Your name (optional)" />
          <button type="submit">Create</button>
        </form>
        <div id="create-ticket-note" style="margin-top:8px;font-size:13px;color:var(--muted)">Anyone can create tickets — sign in at <a href="/admin.html">/admin.html</a> if you're an admin.</div>
      </div>
    </div>

    <div id="main">
      <div class="top-header" style="margin-bottom:8px">
        <div></div>
        <div>
          <button id="btnHomeTopApp" class="top-button" title="Home">Home</button>
        </div>
      </div>
      <div id="handbook" class="section">
        <h2>Handbook</h2>
        <p>Welcome to the Mack Technologies handbook — drop PDF files into the server folder <code>backend/public/PDF handbook/</code> and they will appear below.</p>
        <div id="handbook-list" style="margin-top:12px"></div>
        <!-- PDF viewer: opens selected handbook PDF inside the app -->
        <div id="pdf-viewer" style="display:none; position:relative; margin-top:12px; height:70vh; border:1px solid #e6f0ff; border-radius:6px; overflow:hidden">
          <div style="padding:8px; background:#f5fbff; border-bottom:1px solid #e6f0ff; display:flex; align-items:center; gap:8px">
            <strong id="pdf-title">Document</strong>
            <div style="margin-left:auto">
              <button id="pdf-close" class="btn">Close</button>
            </div>
          </div>
          <iframe id="pdf-frame" style="width:100%; height:calc(100% - 44px); border:0"></iframe>
        </div>
      </div>

      <div id="tickets" class="section">
        <h2>Tickets</h2>
        <div id="tickets-full"></div>
      </div>

      <!-- Help section removed per request -->

      <div id="chat" class="section">
        <h2>Chat</h2>
        <div class="messages" id="messages"></div>
        <form id="chat-form">
          <input id="chat-user" placeholder="Your name" />
          <input id="chat-input" placeholder="Message" required />
          <button type="submit">Send</button>
        </form>
      </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/app.js"></script>
    <script>
      // Home button in the app: return to landing page
      const btnHome = document.getElementById('btnHomeTopApp');
      if (btnHome) btnHome.addEventListener('click', ()=> { window.location.href = '/'; });
      const btnHomeCreate = document.getElementById('btnHomeInCreate');
      if (btnHomeCreate) btnHomeCreate.addEventListener('click', ()=> { window.location.href = '/'; });
    </script>
  </body>
</html>
